<UpiDllConfig>
  <UpiValueRetrieval>
    <upi_element name="upivalue">
      <upi_attribute name="version" value="1.0"/>
      <upi_attribute name="type" value="product"/>
      <upi_element name="level">

           <upi_attribute name="name" value="productline"/>
           <upi_attribute name="id">
            <upi_reader name="StringResourceReader" path="..\acadres.dll" id="14303"/>
           </upi_attribute>

              <upi_element name="level">
              <upi_attribute name="name" value="release"/>
              <upi_attribute name="id">
               <upi_reader name="StringResourceReader" path="..\acadres.dll" id="14319"/>
              </upi_attribute>

                <upi_element name="level">
                <upi_attribute name="name" value="master"/>
                <upi_attribute name="id" >
                 <upi_reader name="RegReader" path="\HKLM\SOFTWARE\Autodesk\AutoCAD\R17.0" iterate="true" target="ProductCode" locationkey="AcadLocation" appliesto="installed"/>
                 <upi_reader name="MSIDBReader" path="..\..\..\acad.msi" property="ProductCode" appliesto="media"/>
                </upi_attribute>

                 <upi_element name="level">
                   <upi_attribute name="name" value="build"/>
                   <upi_attribute name="id">
                    <upi_reader name="FileAttributeReader" path="..\acdb17.dll" attribute="FileVersion" />
                   </upi_attribute>
                 </upi_element>

                </upi_element>
              </upi_element>
           </upi_element>
      </upi_element>
  </UpiValueRetrieval>
</UpiDllConfig>
